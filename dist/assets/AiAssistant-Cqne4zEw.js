import{v as Q,r as d,j as e,M as W,H as X,ag as z,aa as S,B as w,X as Z,ah as ee,ai as te,aj as se,ak as ae}from"./index-528wS5t7.js";import{P as re,T as O}from"./trash-2-Bm_CEVlk.js";const v=()=>Math.random().toString(36).substring(2,9),ie=m=>{if(!m)return"New chat";const o=m.split(" ").slice(0,3).join(" ");return o.length>20?o.substring(0,20)+"...":o},ne=m=>{const a=[/kya/i,/hai/i,/kaise/i,/aap/i,/main/i,/hum/i,/tum/i,/mujhe/i,/hamara/i,/tumhara/i,/karna/i,/ho/i,/raha/i,/gaya/i,/chahiye/i,/nahi/i,/matlab/i,/samajh/i,/batao/i],o=/[\u0900-\u097F]/.test(m),y=/[a-zA-Z]/.test(m);return o&&y?!0:a.some(p=>p.test(m))},oe=(m,a)=>`
You are an AI assistant for the IITM Scholar Hub app. Be helpful, concise, and friendly.

CONVERSATION MEMORY:
- Remember the last 3+ messages in the conversation for context.
- Refer back to previous messages when relevant.

RESPONSE GUIDELINES:
- Keep responses under 40 words unless specifically asked for more detail.
- If asked for detailed information (when user says "Tell me in detail" or similar), provide:
  * Point-wise answers
  * Bold text for important parts (headings, formulas)
  * Clearly show mathematical operations

ABILITIES:
- Solve math problems and statistics questions step-by-step
- Help with programming in various languages
- Assist with English grammar and writing
- Answer conceptual questions about academic subjects

LANGUAGE:
- ${m?"User is communicating in Hinglish (Hindi-English mix). Respond in Hinglish too.":"Respond in English"}
- Be conversational and occasionally humorous where appropriate

IMPORTANT:
- You are already in the AI Assistant page, so don't suggest visiting it.
- Always be direct and concise unless detailed explanation is requested.
- Never use technical jargon unless the user appears technical.
- Never apologize for not having certain capabilities.

FORMATTING:
- Use **bold** for important information
- Use point-form lists for multiple items
- Use proper formatting for code snippets
  `,me=()=>{const{toast:m}=Q(),[a,o]=d.useState(null),[y,p]=d.useState([]),[g,N]=d.useState(""),[E,T]=d.useState(!1),[le,F]=d.useState(null),[j,M]=d.useState(!1),k=d.useRef(null),u=d.useRef(null),L="/api/assistant";d.useEffect(()=>{const s=localStorage.getItem("aiAssistantChats");if(s)try{const t=JSON.parse(s);if(p(t),t.length>0){const r=[...t].sort((l,i)=>i.createdAt-l.createdAt);o(r[0])}}catch(t){console.error("Failed to parse saved chats:",t)}else C()},[]),d.useEffect(()=>{y.length>0&&localStorage.setItem("aiAssistantChats",JSON.stringify(y))},[y]),d.useEffect(()=>(document.body.classList.add("ai-assistant-active"),()=>{document.body.classList.remove("ai-assistant-active")}),[]),d.useEffect(()=>{H()},[a==null?void 0:a.messages]);const H=()=>{k.current&&k.current.scrollIntoView({behavior:"smooth"})},C=()=>{const s={id:v(),title:"New chat",messages:[{id:v(),text:"Hi! I'm your AI assistant. How can I help you today?",isUser:!1,timestamp:Date.now()}],createdAt:Date.now()};p(t=>[s,...t]),o(s),N(""),setTimeout(()=>{u.current&&u.current.focus()},100)},R=s=>{o(s),N(""),setTimeout(()=>{u.current&&u.current.focus()},100)},_=(s,t)=>{t.stopPropagation();const r=y.filter(l=>l.id!==s);p(r),(a==null?void 0:a.id)===s&&(r.length>0?o(r[0]):C())},B=()=>{if(!a)return;const s={...a,messages:[{id:v(),text:"Hi! I'm your AI assistant. How can I help you today?",isUser:!1,timestamp:Date.now()}]};o(s),p(t=>t.map(r=>r.id===a.id?s:r)),m({title:"Chat cleared",description:"Your conversation has been cleared."})},G=s=>{const t=s.target;if(N(t.value),t.style.height="45px",t.scrollHeight>45){const r=Math.min(150,t.scrollHeight);t.style.height=`${r}px`}},U=s=>{let t=s.replace(/\r\n/g,`
`).replace(/##\s+Step\s+\d+:/g,`

$&
`).replace(/(##\s+Step\s+\d+:[^\n]+)\n(?!\n)/g,`$1

`).replace(/\n(##\s+Step)/g,`

$1`).replace(/\\cdot/g,"\\times").replace(/\\left\(/g,"(").replace(/\\right\)/g,")").replace(/\$\$(.*?)\$\$/gs,(r,l)=>`

$$
${l.trim().replace(/\s+/g," ")}
$$

`).replace(/(\w)(\$[^$\n]+\$)(\w)/g,"$1 $2 $3").replace(/Therefore/g,`

**Therefore**`).replace(/(width|height|dimensions)(\s*)(=|:)(\s*)([$\\])/gi,(r,l,i,n,h,c)=>`**${l.charAt(0).toUpperCase()+l.slice(1)}**${n} ${c}`);return t=t.replace(/\n{3,}/g,`

`),t},Y=s=>{let t=s;if([/For detailed problem-solving, try our "?AI Assistant"? page.*/gi,/For (more|detailed) (assistance|help|information|details), (please )?(visit|check|use|go to|head to|try) (the |our )?"?AI Assistant"? page.*/gi,/You can also (try|use|visit|check) (the |our )?"?AI Assistant"? page.*/gi,/I recommend (using|trying|checking) (the |our )?"?AI Assistant"? page.*/gi,/.*AI Assistant.*page.*/gi].forEach(i=>{t=t.replace(i,"")}),t=U(t),t=t.replace(/##\s+Step\s+(\d+):/g,(i,n)=>`## Step ${n}:`),(t.includes("$")||t.includes("\\"))&&(t=t.replace(/\$\$(.*?)\$\$/gs,(i,n)=>`

$$${n}$$

`),t=t.replace(/(\w)\$(\\\w+)/g,"$1 $$$2"),t=t.replace(/(\\\w+)\$(\w)/g,"$1$$ $2"),t=t.replace(/-\s*\$\\frac/g,"- $\\frac")),t=t.replace(/\\cdot/g,"\\times"),t=t.replace(/\\left\\{/g,"\\left\\{"),t=t.replace(/\\right\\}/g,"\\right\\}"),/(dimensions|final answer|rectangle with maximum area).*(width|height)/i.test(t)&&!t.includes("Therefore")){const i=t.match(/[Ww]idth\s*=\s*(?:\\frac\{([^}]+)\}\{([^}]+)\}|\\boxed\{([^}]+)\}|([0-9.\\sqrt{}/]+))/),n=t.match(/[Hh]eight\s*=\s*(?:\\frac\{([^}]+)\}\{([^}]+)\}|\\boxed\{([^}]+)\}|([0-9.\\sqrt{}/]+))/);if(i&&n){const h=i[1]&&i[2]?`\\frac{${i[1]}}{${i[2]}}`:i[3]?i[3]:i[4],c=n[1]&&n[2]?`\\frac{${n[1]}}{${n[2]}}`:n[3]?n[3]:n[4];h&&c&&(t+=`

**Therefore, the dimensions of the rectangle with maximum area are:**
- Width = $${h}$
- Height = $${c}$`)}}return t},P=async s=>{var l,i,n;if(s.preventDefault(),!g.trim()||!a)return;const t={id:v(),text:g.trim(),isUser:!0,timestamp:Date.now()},r={...a,title:a.messages.length<=1?ie(g.trim()):a.title,messages:[...a.messages,t]};o(r),p(h=>h.map(c=>c.id===a.id?r:c)),N(""),T(!0),F(null),u.current&&(u.current.style.height="45px");try{const h=r.messages.slice(-4),c=ne(g.trim()),$=/detail|step|explain|elaborate|clarify|breakdown/i.test(g.trim()),A=oe(c,$);console.log("Sending request with context:",A);const b=await fetch(L,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:[{role:"system",content:A},...h.map(f=>({role:f.isUser?"user":"assistant",content:f.text}))],max_tokens:$?1e3:500,temperature:.7,top_p:.9,frequency_penalty:0,presence_penalty:0})});if(!b.ok){let f=`Failed to get response: ${b.status}`;try{const x=await b.json();f=x.error||x.details||f,console.error("Error response:",x)}catch(x){console.error("Error parsing error response:",x)}throw new Error(f)}const I=await b.json();if(console.log("Received response:",I),!((n=(i=(l=I.choices)==null?void 0:l[0])==null?void 0:i.message)!=null&&n.content))throw console.error("Invalid response format:",I),new Error("Invalid response format from API");const J=Y(I.choices[0].message.content.trim()),K={id:v(),text:U(J),isUser:!1,timestamp:Date.now()},D={...r,messages:[...r.messages,K]};o(D),p(f=>f.map(x=>x.id===a.id?D:x))}catch(h){console.error("Error details:",h);const c=h.name==="AbortError"?"Request timed out. Please try again.":h.message||"Failed to connect. Please try again.";m({title:"Error",description:c,variant:"destructive",duration:5e3});const $={...r,messages:[...r.messages,{id:v(),text:c,isUser:!1,timestamp:Date.now()}]};o($),p(A=>A.map(b=>b.id===a.id?$:b))}finally{T(!1),setTimeout(()=>{u.current&&u.current.focus(),H()},100)}},q=()=>{M(!j)},V=s=>{R(s),M(!1)};return e.jsxs(W,{children:[e.jsxs(X,{children:[e.jsx("title",{children:"AI Assistant & Math Question Solver | IITM Scholar Hub"}),e.jsx("meta",{name:"description",content:"Get instant help with math problems, programming, and academic questions. Our free AI Assistant provides step-by-step solutions for calculus, algebra, statistics and more. The perfect math question solver for students."}),e.jsx("meta",{name:"keywords",content:"free AI assistant, math question solver, free math solver, step by step math solutions, programming help, AI homework helper, IITM AI assistant, free question solver, coding assistant"}),e.jsx("meta",{property:"og:title",content:"Free AI Assistant & Math Question Solver | IITM Scholar Hub"}),e.jsx("meta",{property:"og:description",content:"Get instant help with math problems, programming, and academic questions with our free AI Assistant."}),e.jsx("meta",{property:"og:type",content:"website"}),e.jsx("meta",{property:"og:site_name",content:"IITM Scholar Hub"}),e.jsx("meta",{property:"og:url",content:"https://iitm-scholar-hub.vercel.app/ai-assistant"}),e.jsx("meta",{property:"og:image",content:"https://iitm-scholar-hub.vercel.app/og-image.svg"}),e.jsx("meta",{property:"og:image:width",content:"1200"}),e.jsx("meta",{property:"og:image:height",content:"630"}),e.jsx("meta",{name:"twitter:title",content:"Free AI Assistant & Math Question Solver"}),e.jsx("meta",{name:"twitter:description",content:"Get instant solutions for math problems, programming, and academic questions."}),e.jsx("meta",{name:"twitter:card",content:"summary_large_image"}),e.jsx("meta",{name:"twitter:image",content:"https://iitm-scholar-hub.vercel.app/og-image.svg"})]}),e.jsx("div",{className:"fixed inset-0 pt-16 overflow-hidden",children:e.jsxs("div",{className:"flex flex-col md:flex-row h-full",children:[e.jsx(z,{children:j&&e.jsx(S.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"md:hidden fixed inset-0 bg-black/50 z-40",onClick:()=>M(!1)})}),e.jsx(z,{children:(j||!["xs","sm"].includes("md"))&&e.jsx(S.div,{initial:{x:-280,opacity:0},animate:{x:0,opacity:1},exit:{x:-280,opacity:0},transition:{duration:.2},className:`${j?"fixed left-0 top-16 bottom-0 z-50":"hidden md:block"} md:relative md:w-64 lg:w-72 shrink-0 bg-[#0f172a] border-r border-gray-800 h-full no-scrollbar`,children:e.jsxs("div",{className:"h-full overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"p-4 border-b border-gray-800 flex items-center justify-between",children:[e.jsx("h3",{className:"text-base font-semibold text-white",children:"AI Assistant"}),e.jsx(w,{variant:"ghost",size:"icon",onClick:q,className:"md:hidden text-white hover:bg-gray-700/50",children:e.jsx(Z,{size:20})})]}),e.jsx("div",{className:"p-3",children:e.jsxs(w,{onClick:C,className:"w-full justify-start text-sm font-normal h-10 bg-blue-600 hover:bg-blue-700 text-white",children:[e.jsx(re,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"New Chat"})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-3 space-y-2",children:y.map(s=>e.jsxs("div",{onClick:()=>j?V(s):R(s),className:`p-2 rounded-md cursor-pointer transition-all flex items-center justify-between group chat-history-item ${(a==null?void 0:a.id)===s.id?"active":""}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 truncate",children:[e.jsx(ee,{className:"h-4 w-4 shrink-0"}),e.jsx("span",{className:"truncate text-sm",children:s.title})]}),e.jsx(w,{variant:"ghost",size:"icon",className:"h-6 w-6 opacity-0 group-hover:opacity-100 text-gray-400 hover:text-white hover:bg-gray-600",onClick:t=>_(s.id,t),children:e.jsx(O,{className:"h-3 w-3"})})]},s.id))}),e.jsx("div",{className:"mt-auto p-4 border-t border-gray-800",children:e.jsxs(w,{variant:"outline",className:"w-full justify-start text-sm font-normal h-10 border-dashed border-gray-700 text-gray-300 hover:text-white hover:border-gray-600",onClick:B,children:[e.jsx(O,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Clear conversation"})]})})]})})}),e.jsxs("div",{className:"flex-1 flex flex-col bg-[#0f172a] overflow-hidden relative",children:[e.jsx("div",{className:"p-2 border-b border-gray-800 flex items-center justify-between md:hidden",children:e.jsxs(w,{variant:"outline",size:"sm",className:"h-9 border-gray-700",onClick:q,children:[e.jsx(te,{className:"h-4 w-4 mr-2"}),e.jsx("span",{children:"Chats"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-4 md:px-6 py-4 md:py-6 scrollbar-thin scrollbar-thumb-gray-600 scrollbar-track-transparent messages-container bg-[#0f172a] no-scrollbar",children:[a==null?void 0:a.messages.map((s,t)=>e.jsx(S.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:`flex ${s.isUser?"justify-end":"justify-start"} mb-4`,children:e.jsxs("div",{className:"flex items-start gap-3 max-w-[80%]",children:[!s.isUser&&e.jsx("div",{className:"w-2 rounded-full bg-gradient-to-br from-blue-500 to-violet-600"}),e.jsx(se,{message:s.text,isUser:s.isUser})]})},s.id)),e.jsx("div",{ref:k}),E&&e.jsx(S.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"flex justify-start mb-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-2 rounded-full bg-gradient-to-br from-blue-500 to-violet-600"}),e.jsx("div",{className:"px-4 py-3 rounded-2xl bg-[#1E2330] border border-gray-800",children:e.jsxs("div",{className:"flex space-x-2 typing-indicator",children:[e.jsx("div",{className:"typing-dot"}),e.jsx("div",{className:"typing-dot"}),e.jsx("div",{className:"typing-dot"})]})})]})})]}),e.jsx("div",{className:"border-t border-gray-800 p-3 md:p-4 bg-[#0f172a] sticky bottom-0 z-10 shadow-sm input-container",children:e.jsx("form",{onSubmit:P,className:"flex gap-2 items-end",children:e.jsxs("div",{className:"relative flex-1",children:[e.jsx("textarea",{ref:u,value:g,onChange:G,onKeyDown:s=>{s.key==="Enter"&&!s.shiftKey&&(s.preventDefault(),P(s))},placeholder:"Ask anything...",className:"w-full bg-[#1E2330] border border-gray-700 rounded-xl px-4 py-3 text-sm text-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent resize-none pr-12 chat-input",style:{height:"50px",maxHeight:"150px",overflow:"auto",lineHeight:"1.5"},disabled:E}),e.jsx(w,{type:"submit",size:"icon",className:`absolute right-2 bottom-2 h-9 w-9 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center justify-center disabled:opacity-50 disabled:pointer-events-none transition-all duration-200 ${g.trim()?"send-button-ready":""}`,disabled:E||!g.trim(),children:e.jsx(ae,{size:16})})]})})})]})]})})]})};export{me as default};
